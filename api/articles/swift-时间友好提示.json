{"title":"swift 时间友好提示","slug":"swift-时间友好提示","date":"2017-04-05T08:10:20.000Z","updated":"2017-04-05T08:16:25.000Z","comments":true,"path":"api/articles/swift-时间友好提示.json","excerpt":"","content":"<p>废话不多直接上代码</p>\n<blockquote>\n<p>备注 NSLocalizedString()是国际化支持</p>\n</blockquote>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\"><span class=\"comment\">//  TimeAgo.swift</span></div><div class=\"line\"><span class=\"comment\">//  TimeAgo</span></div><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\"><span class=\"comment\">//  Created by roycms on 2017/3/15.</span></div><div class=\"line\"><span class=\"comment\">//  Copyright © 2017年 北京三芳科技有限公司. All rights reserved.</span></div><div class=\"line\"><span class=\"comment\">//</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> Foundation</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">NSDate</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ago</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> funTimeAgo(<span class=\"keyword\">self</span> <span class=\"keyword\">as</span> <span class=\"type\">Date</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">var</span> timeAgo:<span class=\"type\">String</span>&#123;</div><div class=\"line\">        <span class=\"keyword\">get</span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> funTimeAgo(<span class=\"keyword\">self</span> <span class=\"keyword\">as</span> <span class=\"type\">Date</span>)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">Double</span> </span>&#123;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">ago</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">String</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> funStampTimeAgo(<span class=\"keyword\">self</span> <span class=\"keyword\">as</span> <span class=\"type\">Double</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">var</span> timeAgo:<span class=\"type\">String</span>&#123;</div><div class=\"line\">        <span class=\"keyword\">get</span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> funStampTimeAgo(<span class=\"keyword\">self</span> <span class=\"keyword\">as</span> <span class=\"type\">Double</span>)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">funStampTimeAgo</span><span class=\"params\">(<span class=\"number\">_</span> date: Double)</span></span> -&gt; <span class=\"type\">String</span>&#123;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">return</span> funTimeAgo(<span class=\"type\">NSDate</span>(timeIntervalSince1970: <span class=\"type\">TimeInterval</span>(date)) <span class=\"keyword\">as</span> <span class=\"type\">Date</span>)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">funTimeAgo</span><span class=\"params\">(<span class=\"number\">_</span> date: Date)</span></span> -&gt; <span class=\"type\">String</span> &#123;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> calendar = <span class=\"type\">Calendar</span>.current</div><div class=\"line\">    <span class=\"keyword\">let</span> now = <span class=\"type\">Date</span>()</div><div class=\"line\">    <span class=\"keyword\">let</span> unitFlags: <span class=\"type\">NSCalendar</span>.<span class=\"type\">Unit</span> = [.second, .minute, .hour, .day, .weekOfYear, .month, .year]</div><div class=\"line\">    <span class=\"keyword\">let</span> components = (calendar <span class=\"keyword\">as</span> <span class=\"type\">NSCalendar</span>).components(unitFlags, from: date, to: now, options: [])</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> year = components.year, year &gt;= <span class=\"number\">2</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"<span class=\"subst\">\\(year)</span> \"</span> + <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"yearsAgo\"</span>,comment:<span class=\"string\">\"years ago\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> year = components.year, year &gt;= <span class=\"number\">1</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span>  <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"LastYear\"</span>,comment:<span class=\"string\">\"Last year\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> month = components.month, month &gt;= <span class=\"number\">2</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"<span class=\"subst\">\\(month)</span> \"</span> + <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"monthsAgo\"</span>,comment:<span class=\"string\">\"months ago\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> month = components.month, month &gt;= <span class=\"number\">1</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"LastMonth\"</span>,comment:<span class=\"string\">\"Last month\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> week = components.weekOfYear, week &gt;= <span class=\"number\">2</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"<span class=\"subst\">\\(week)</span> \"</span> + <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"weeksAgo\"</span>,comment:<span class=\"string\">\"weeks ago\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> week = components.weekOfYear, week &gt;= <span class=\"number\">1</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"LastWeek\"</span>,comment:<span class=\"string\">\"Last week\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> day = components.day, day &gt;= <span class=\"number\">2</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"<span class=\"subst\">\\(day)</span> \"</span> + <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"daysAgo\"</span>,comment:<span class=\"string\">\"days ago\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> day = components.day, day &gt;= <span class=\"number\">1</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span>  <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"Yesterday\"</span>,comment:<span class=\"string\">\"Yesterday\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> hour = components.hour, hour &gt;= <span class=\"number\">2</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"<span class=\"subst\">\\(hour)</span> \"</span> + <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"hoursAgo\"</span>,comment:<span class=\"string\">\"hours ago\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> hour = components.hour, hour &gt;= <span class=\"number\">1</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"AnHourAgo\"</span>,comment:<span class=\"string\">\"An hour ago\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> minute = components.minute, minute &gt;= <span class=\"number\">2</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"<span class=\"subst\">\\(minute)</span> \"</span> + <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"minutesAgo\"</span>,comment:<span class=\"string\">\"minutes ago\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> minute = components.minute, minute &gt;= <span class=\"number\">1</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span>  <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"AMinuteAgo\"</span>,comment:<span class=\"string\">\"A minute ago\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> second = components.second, second &gt;= <span class=\"number\">3</span> &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"<span class=\"subst\">\\(second)</span> \"</span> + <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"secondsAgo\"</span>,comment:<span class=\"string\">\"seconds ago\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"type\">NSLocalizedString</span>(<span class=\"string\">\"JustNow\"</span>,comment:<span class=\"string\">\"Just now\"</span>)</div><div class=\"line\">    </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>","categories":[],"tags":[]}