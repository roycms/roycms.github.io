{"title":"swift 时间友好提示","slug":"swift-时间友好提示","date":"2017-04-05T08:10:20.000Z","updated":"2017-04-05T08:11:20.000Z","comments":true,"path":"api/articles/swift-时间友好提示.json","excerpt":"","content":"<p>废话不多直接上代码</p>\n<blockquote>\n<p>备注 NSLocalizedString()是国际化支持</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div></pre></td><td class=\"code\"><pre><div class=\"line\">//</div><div class=\"line\">//  TimeAgo.swift</div><div class=\"line\">//  TimeAgo</div><div class=\"line\">//</div><div class=\"line\">//  Created by roycms on 2017/3/15.</div><div class=\"line\">//  Copyright © 2017年 北京三芳科技有限公司. All rights reserved.</div><div class=\"line\">//</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">import Foundation</div><div class=\"line\"></div><div class=\"line\">public extension NSDate &#123;</div><div class=\"line\">    public func ago() -&gt; String &#123;</div><div class=\"line\">        return funTimeAgo(self as Date)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    public var timeAgo:String&#123;</div><div class=\"line\">        get&#123;</div><div class=\"line\">            return funTimeAgo(self as Date)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\">public extension Double &#123;</div><div class=\"line\">    </div><div class=\"line\">    public func ago() -&gt; String &#123;</div><div class=\"line\">        return funStampTimeAgo(self as Double)</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">    public var timeAgo:String&#123;</div><div class=\"line\">        get&#123;</div><div class=\"line\">            return funStampTimeAgo(self as Double)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">func funStampTimeAgo(_ date: Double) -&gt; String&#123;</div><div class=\"line\">    </div><div class=\"line\">    return funTimeAgo(NSDate(timeIntervalSince1970: TimeInterval(date)) as Date)</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\">func funTimeAgo(_ date: Date) -&gt; String &#123;</div><div class=\"line\">    </div><div class=\"line\">    let calendar = Calendar.current</div><div class=\"line\">    let now = Date()</div><div class=\"line\">    let unitFlags: NSCalendar.Unit = [.second, .minute, .hour, .day, .weekOfYear, .month, .year]</div><div class=\"line\">    let components = (calendar as NSCalendar).components(unitFlags, from: date, to: now, options: [])</div><div class=\"line\">    </div><div class=\"line\">    if let year = components.year, year &gt;= 2 &#123;</div><div class=\"line\">        return &quot;\\(year) &quot; + NSLocalizedString(&quot;yearsAgo&quot;,comment:&quot;years ago&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let year = components.year, year &gt;= 1 &#123;</div><div class=\"line\">        return  NSLocalizedString(&quot;LastYear&quot;,comment:&quot;Last year&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let month = components.month, month &gt;= 2 &#123;</div><div class=\"line\">        return &quot;\\(month) &quot; + NSLocalizedString(&quot;monthsAgo&quot;,comment:&quot;months ago&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let month = components.month, month &gt;= 1 &#123;</div><div class=\"line\">        return NSLocalizedString(&quot;LastMonth&quot;,comment:&quot;Last month&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let week = components.weekOfYear, week &gt;= 2 &#123;</div><div class=\"line\">        return &quot;\\(week) &quot; + NSLocalizedString(&quot;weeksAgo&quot;,comment:&quot;weeks ago&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let week = components.weekOfYear, week &gt;= 1 &#123;</div><div class=\"line\">        return NSLocalizedString(&quot;LastWeek&quot;,comment:&quot;Last week&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let day = components.day, day &gt;= 2 &#123;</div><div class=\"line\">        return &quot;\\(day) &quot; + NSLocalizedString(&quot;daysAgo&quot;,comment:&quot;days ago&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let day = components.day, day &gt;= 1 &#123;</div><div class=\"line\">        return  NSLocalizedString(&quot;Yesterday&quot;,comment:&quot;Yesterday&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let hour = components.hour, hour &gt;= 2 &#123;</div><div class=\"line\">        return &quot;\\(hour) &quot; + NSLocalizedString(&quot;hoursAgo&quot;,comment:&quot;hours ago&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let hour = components.hour, hour &gt;= 1 &#123;</div><div class=\"line\">        return NSLocalizedString(&quot;AnHourAgo&quot;,comment:&quot;An hour ago&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let minute = components.minute, minute &gt;= 2 &#123;</div><div class=\"line\">        return &quot;\\(minute) &quot; + NSLocalizedString(&quot;minutesAgo&quot;,comment:&quot;minutes ago&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let minute = components.minute, minute &gt;= 1 &#123;</div><div class=\"line\">        return  NSLocalizedString(&quot;AMinuteAgo&quot;,comment:&quot;A minute ago&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    if let second = components.second, second &gt;= 3 &#123;</div><div class=\"line\">        return &quot;\\(second) &quot; + NSLocalizedString(&quot;secondsAgo&quot;,comment:&quot;seconds ago&quot;)</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    return NSLocalizedString(&quot;JustNow&quot;,comment:&quot;Just now&quot;)</div><div class=\"line\">    </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>","categories":[],"tags":[]}