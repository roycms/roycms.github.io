{"title":"万象优图接口 swift","slug":"万象优图接口","date":"2017-04-17T08:13:38.000Z","updated":"2017-04-24T02:39:21.000Z","comments":true,"path":"api/articles/万象优图接口.json","excerpt":"","content":"<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div><div class=\"line\">170</div><div class=\"line\">171</div><div class=\"line\">172</div><div class=\"line\">173</div><div class=\"line\">174</div><div class=\"line\">175</div><div class=\"line\">176</div><div class=\"line\">177</div><div class=\"line\">178</div><div class=\"line\">179</div><div class=\"line\">180</div><div class=\"line\">181</div><div class=\"line\">182</div><div class=\"line\">183</div><div class=\"line\">184</div><div class=\"line\">185</div><div class=\"line\">186</div><div class=\"line\">187</div><div class=\"line\">188</div><div class=\"line\">189</div><div class=\"line\">190</div><div class=\"line\">191</div><div class=\"line\">192</div><div class=\"line\">193</div><div class=\"line\">194</div><div class=\"line\">195</div><div class=\"line\">196</div><div class=\"line\">197</div><div class=\"line\">198</div><div class=\"line\">199</div><div class=\"line\">200</div><div class=\"line\">201</div><div class=\"line\">202</div><div class=\"line\">203</div><div class=\"line\">204</div><div class=\"line\">205</div><div class=\"line\">206</div><div class=\"line\">207</div><div class=\"line\">208</div><div class=\"line\">209</div><div class=\"line\">210</div><div class=\"line\">211</div><div class=\"line\">212</div><div class=\"line\">213</div><div class=\"line\">214</div><div class=\"line\">215</div><div class=\"line\">216</div><div class=\"line\">217</div><div class=\"line\">218</div><div class=\"line\">219</div><div class=\"line\">220</div><div class=\"line\">221</div><div class=\"line\">222</div><div class=\"line\">223</div><div class=\"line\">224</div><div class=\"line\">225</div><div class=\"line\">226</div><div class=\"line\">227</div><div class=\"line\">228</div><div class=\"line\">229</div><div class=\"line\">230</div><div class=\"line\">231</div><div class=\"line\">232</div><div class=\"line\">233</div><div class=\"line\">234</div><div class=\"line\">235</div><div class=\"line\">236</div><div class=\"line\">237</div><div class=\"line\">238</div><div class=\"line\">239</div><div class=\"line\">240</div><div class=\"line\">241</div><div class=\"line\">242</div><div class=\"line\">243</div><div class=\"line\">244</div><div class=\"line\">245</div><div class=\"line\">246</div><div class=\"line\">247</div><div class=\"line\">248</div><div class=\"line\">249</div><div class=\"line\">250</div><div class=\"line\">251</div><div class=\"line\">252</div><div class=\"line\">253</div><div class=\"line\">254</div><div class=\"line\">255</div><div class=\"line\">256</div><div class=\"line\">257</div><div class=\"line\">258</div><div class=\"line\">259</div><div class=\"line\">260</div><div class=\"line\">261</div><div class=\"line\">262</div><div class=\"line\">263</div><div class=\"line\">264</div><div class=\"line\">265</div><div class=\"line\">266</div><div class=\"line\">267</div><div class=\"line\">268</div><div class=\"line\">269</div><div class=\"line\">270</div><div class=\"line\">271</div><div class=\"line\">272</div><div class=\"line\">273</div><div class=\"line\">274</div><div class=\"line\">275</div><div class=\"line\">276</div><div class=\"line\">277</div><div class=\"line\">278</div><div class=\"line\">279</div><div class=\"line\">280</div><div class=\"line\">281</div><div class=\"line\">282</div><div class=\"line\">283</div><div class=\"line\">284</div><div class=\"line\">285</div><div class=\"line\">286</div><div class=\"line\">287</div><div class=\"line\">288</div><div class=\"line\">289</div><div class=\"line\">290</div><div class=\"line\">291</div><div class=\"line\">292</div><div class=\"line\">293</div><div class=\"line\">294</div><div class=\"line\">295</div><div class=\"line\">296</div><div class=\"line\">297</div><div class=\"line\">298</div><div class=\"line\">299</div><div class=\"line\">300</div><div class=\"line\">301</div><div class=\"line\">302</div><div class=\"line\">303</div><div class=\"line\">304</div><div class=\"line\">305</div><div class=\"line\">306</div><div class=\"line\">307</div><div class=\"line\">308</div><div class=\"line\">309</div><div class=\"line\">310</div><div class=\"line\">311</div><div class=\"line\">312</div><div class=\"line\">313</div><div class=\"line\">314</div><div class=\"line\">315</div><div class=\"line\">316</div><div class=\"line\">317</div><div class=\"line\">318</div><div class=\"line\">319</div><div class=\"line\">320</div><div class=\"line\">321</div><div class=\"line\">322</div><div class=\"line\">323</div><div class=\"line\">324</div><div class=\"line\">325</div><div class=\"line\">326</div><div class=\"line\">327</div><div class=\"line\">328</div><div class=\"line\">329</div><div class=\"line\">330</div><div class=\"line\">331</div><div class=\"line\">332</div><div class=\"line\">333</div><div class=\"line\">334</div><div class=\"line\">335</div><div class=\"line\">336</div><div class=\"line\">337</div><div class=\"line\">338</div><div class=\"line\">339</div><div class=\"line\">340</div><div class=\"line\">341</div><div class=\"line\">342</div><div class=\"line\">343</div><div class=\"line\">344</div><div class=\"line\">345</div><div class=\"line\">346</div><div class=\"line\">347</div><div class=\"line\">348</div><div class=\"line\">349</div><div class=\"line\">350</div><div class=\"line\">351</div><div class=\"line\">352</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//        UIImageWriteToSavedPhotosAlbum(newImage, self, #selector(savedPhotosAlbum(image:didFinishSavingWithError:contextInfo:)), nil)</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">savedPhotosAlbum</span><span class=\"params\">(image: UIImage, didFinishSavingWithError error: NSError?, contextInfo: AnyObject)</span></span> &#123;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">if</span> error != <span class=\"literal\">nil</span> &#123;</div><div class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"存到相册失败\"</span>)</div><div class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"存到相册成功\"</span>)</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 检测给定图片中的所有人脸(Face)的位置和相应的面部属性。位置包括(x, y, w, h)，面部属性包括性别(gender), 年龄(age), 表情(expression), 魅力(beauty), 眼镜(glass)和姿态(pitch，roll，yaw)。</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">detect</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 1.get token</span></div><div class=\"line\">    <span class=\"type\">CloudManager</span>.getToken &#123; (<span class=\"type\">Any</span>) <span class=\"keyword\">in</span></div><div class=\"line\">        <span class=\"keyword\">self</span>.newPerson()</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> url = <span class=\"string\">\"http://service.image.myqcloud.com/face/detect\"</span></div><div class=\"line\">    <span class=\"keyword\">let</span> parameters1: <span class=\"type\">Parameters</span> = [</div><div class=\"line\">        <span class=\"string\">\"appid\"</span>: <span class=\"string\">\"1253464289\"</span>,</div><div class=\"line\">        <span class=\"string\">\"bucket\"</span>: <span class=\"string\">\"taoxi\"</span>,</div><div class=\"line\">        <span class=\"string\">\"mode\"</span>:<span class=\"string\">\"0\"</span>,</div><div class=\"line\">        <span class=\"string\">\"url\"</span>:<span class=\"string\">\"http://taoxi-1253464289.pictj.myqcloud.com/1491812091.71443.jpg\"</span>]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> headers: <span class=\"type\">HTTPHeaders</span> = [</div><div class=\"line\">        <span class=\"string\">\"Host\"</span>: <span class=\"string\">\"service.image.myqcloud.com\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Authorization\"</span>:<span class=\"type\">CloudManager</span>.share.sign</div><div class=\"line\">    ]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"type\">Alamofire</span>.request(url, method: .post, parameters: parameters1, encoding: <span class=\"type\">JSONEncoding</span>.<span class=\"keyword\">default</span>,headers:headers).responseJSON &#123; (responseObject) -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></div><div class=\"line\">        </div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isSuccess &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> <span class=\"type\">JSON</span> = responseObject.result.value</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"type\">JSON</span> != <span class=\"literal\">nil</span>) &#123;</div><div class=\"line\">                <span class=\"comment\">//成功</span></div><div class=\"line\">                </div><div class=\"line\">                <span class=\"built_in\">debugPrint</span>(<span class=\"type\">JSON</span>!)</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                <span class=\"comment\">//失败</span></div><div class=\"line\">                </div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isFailure &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> httpError: <span class=\"type\">NSError</span> = responseObject.result.error! <span class=\"keyword\">as</span> <span class=\"type\">NSError</span></div><div class=\"line\">            <span class=\"keyword\">let</span> statusCode = httpError.code</div><div class=\"line\">            <span class=\"keyword\">let</span> error:<span class=\"type\">NSDictionary</span> = [<span class=\"string\">\"error\"</span> : httpError,<span class=\"string\">\"statusCode\"</span> : statusCode]</div><div class=\"line\">            <span class=\"built_in\">print</span>(error)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">faceIdentify</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 1.get token</span></div><div class=\"line\">    <span class=\"type\">CloudManager</span>.getToken &#123; (<span class=\"type\">Any</span>) <span class=\"keyword\">in</span></div><div class=\"line\">        <span class=\"keyword\">self</span>.faceIdentify()</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> url = <span class=\"string\">\"http://service.image.myqcloud.com/face/identify\"</span></div><div class=\"line\">    <span class=\"keyword\">let</span> parameters1: <span class=\"type\">Parameters</span> = [</div><div class=\"line\">        <span class=\"string\">\"appid\"</span>: <span class=\"string\">\"1253464289\"</span>,</div><div class=\"line\">        <span class=\"string\">\"bucket\"</span>: <span class=\"string\">\"taoxi\"</span>,</div><div class=\"line\">        <span class=\"string\">\"group_id\"</span>:<span class=\"string\">\"contrastGroup\"</span>,</div><div class=\"line\">        <span class=\"string\">\"url\"</span>:<span class=\"string\">\"http://taoxi-1253464289.costj.myqcloud.com/1492053505.00994.jpg\"</span>]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> headers: <span class=\"type\">HTTPHeaders</span> = [</div><div class=\"line\">        <span class=\"string\">\"Host\"</span>: <span class=\"string\">\"service.image.myqcloud.com\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Authorization\"</span>:<span class=\"type\">CloudManager</span>.share.sign</div><div class=\"line\">    ]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"type\">Alamofire</span>.request(url, method: .post, parameters: parameters1, encoding: <span class=\"type\">JSONEncoding</span>.<span class=\"keyword\">default</span>,headers:headers).responseJSON &#123; (responseObject) -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></div><div class=\"line\">        </div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isSuccess &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> <span class=\"type\">JSON</span> = responseObject.result.value</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"type\">JSON</span> != <span class=\"literal\">nil</span>) &#123;</div><div class=\"line\">                <span class=\"comment\">//成功</span></div><div class=\"line\">                </div><div class=\"line\">                <span class=\"built_in\">debugPrint</span>(<span class=\"type\">JSON</span>!)</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                <span class=\"comment\">//失败</span></div><div class=\"line\">                </div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isFailure &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> httpError: <span class=\"type\">NSError</span> = responseObject.result.error! <span class=\"keyword\">as</span> <span class=\"type\">NSError</span></div><div class=\"line\">            <span class=\"keyword\">let</span> statusCode = httpError.code</div><div class=\"line\">            <span class=\"keyword\">let</span> error:<span class=\"type\">NSDictionary</span> = [<span class=\"string\">\"error\"</span> : httpError,<span class=\"string\">\"statusCode\"</span> : statusCode]</div><div class=\"line\">            <span class=\"built_in\">print</span>(error)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 给定一个图片和一个Person，检查是否是同一个人。</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">faceVerify</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 1.get token</span></div><div class=\"line\">    <span class=\"type\">CloudManager</span>.getToken &#123; (<span class=\"type\">Any</span>) <span class=\"keyword\">in</span></div><div class=\"line\">        <span class=\"keyword\">self</span>.faceVerify()</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> url = <span class=\"string\">\"http://service.image.myqcloud.com/face/verify\"</span></div><div class=\"line\">    <span class=\"keyword\">let</span> parameters1: <span class=\"type\">Parameters</span> = [</div><div class=\"line\">        <span class=\"string\">\"appid\"</span>: <span class=\"string\">\"1253464289\"</span>,</div><div class=\"line\">        <span class=\"string\">\"bucket\"</span>: <span class=\"string\">\"taoxi\"</span>,</div><div class=\"line\">        <span class=\"string\">\"person_id\"</span>:<span class=\"string\">\"duyaohui\"</span>,</div><div class=\"line\">        <span class=\"string\">\"url\"</span>:<span class=\"string\">\"http://taoxi-1253464289.costj.myqcloud.com/1492053504.97242.jpg\"</span>]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> headers: <span class=\"type\">HTTPHeaders</span> = [</div><div class=\"line\">        <span class=\"string\">\"Host\"</span>: <span class=\"string\">\"service.image.myqcloud.com\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Authorization\"</span>:<span class=\"type\">CloudManager</span>.share.sign</div><div class=\"line\">    ]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"type\">Alamofire</span>.request(url, method: .post, parameters: parameters1, encoding: <span class=\"type\">JSONEncoding</span>.<span class=\"keyword\">default</span>,headers:headers).responseJSON &#123; (responseObject) -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></div><div class=\"line\">        </div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isSuccess &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> <span class=\"type\">JSON</span> = responseObject.result.value</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"type\">JSON</span> != <span class=\"literal\">nil</span>) &#123;</div><div class=\"line\">                <span class=\"comment\">//成功</span></div><div class=\"line\">                </div><div class=\"line\">                <span class=\"built_in\">debugPrint</span>(<span class=\"type\">JSON</span>!)</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                <span class=\"comment\">//失败</span></div><div class=\"line\">                </div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isFailure &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> httpError: <span class=\"type\">NSError</span> = responseObject.result.error! <span class=\"keyword\">as</span> <span class=\"type\">NSError</span></div><div class=\"line\">            <span class=\"keyword\">let</span> statusCode = httpError.code</div><div class=\"line\">            <span class=\"keyword\">let</span> error:<span class=\"type\">NSDictionary</span> = [<span class=\"string\">\"error\"</span> : httpError,<span class=\"string\">\"statusCode\"</span> : statusCode]</div><div class=\"line\">            <span class=\"built_in\">print</span>(error)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//获取1999916287842615047人脸信息</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">getfaceinfo</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 1.get token</span></div><div class=\"line\">    <span class=\"type\">CloudManager</span>.getToken &#123; (<span class=\"type\">Any</span>) <span class=\"keyword\">in</span></div><div class=\"line\">        <span class=\"keyword\">self</span>.newPerson()</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> url = <span class=\"string\">\"http://service.image.myqcloud.com/face/getfaceinfo\"</span></div><div class=\"line\">    <span class=\"keyword\">let</span> parameters1: <span class=\"type\">Parameters</span> = [</div><div class=\"line\">        <span class=\"string\">\"appid\"</span>: <span class=\"string\">\"1253464289\"</span>,</div><div class=\"line\">        <span class=\"string\">\"bucket\"</span>: <span class=\"string\">\"taoxi\"</span>,</div><div class=\"line\">        <span class=\"string\">\"face_id\"</span>:<span class=\"string\">\"1999916287842615047\"</span>]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> headers: <span class=\"type\">HTTPHeaders</span> = [</div><div class=\"line\">        <span class=\"string\">\"Host\"</span>: <span class=\"string\">\"service.image.myqcloud.com\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Authorization\"</span>:<span class=\"type\">CloudManager</span>.share.sign</div><div class=\"line\">    ]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"type\">Alamofire</span>.request(url, method: .post, parameters: parameters1, encoding: <span class=\"type\">JSONEncoding</span>.<span class=\"keyword\">default</span>,headers:headers).responseJSON &#123; (responseObject) -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></div><div class=\"line\">        </div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isSuccess &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> <span class=\"type\">JSON</span> = responseObject.result.value</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"type\">JSON</span> != <span class=\"literal\">nil</span>) &#123;</div><div class=\"line\">                <span class=\"comment\">//成功</span></div><div class=\"line\">                </div><div class=\"line\">                <span class=\"built_in\">debugPrint</span>(<span class=\"type\">JSON</span>!)</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                <span class=\"comment\">//失败</span></div><div class=\"line\">                </div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isFailure &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> httpError: <span class=\"type\">NSError</span> = responseObject.result.error! <span class=\"keyword\">as</span> <span class=\"type\">NSError</span></div><div class=\"line\">            <span class=\"keyword\">let</span> statusCode = httpError.code</div><div class=\"line\">            <span class=\"keyword\">let</span> error:<span class=\"type\">NSDictionary</span> = [<span class=\"string\">\"error\"</span> : httpError,<span class=\"string\">\"statusCode\"</span> : statusCode]</div><div class=\"line\">            <span class=\"built_in\">print</span>(error)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//获取person信息</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">getinfo</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 1.get token</span></div><div class=\"line\">    <span class=\"type\">CloudManager</span>.getToken &#123; (<span class=\"type\">Any</span>) <span class=\"keyword\">in</span></div><div class=\"line\">        <span class=\"keyword\">self</span>.newPerson()</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> url = <span class=\"string\">\"http://service.image.myqcloud.com/face/getinfo\"</span></div><div class=\"line\">    <span class=\"keyword\">let</span> parameters1: <span class=\"type\">Parameters</span> = [</div><div class=\"line\">        <span class=\"string\">\"appid\"</span>: <span class=\"string\">\"1253464289\"</span>,</div><div class=\"line\">        <span class=\"string\">\"bucket\"</span>: <span class=\"string\">\"taoxi\"</span>,</div><div class=\"line\">        <span class=\"string\">\"group_ids\"</span>:[ <span class=\"string\">\"a007\"</span>],</div><div class=\"line\">        <span class=\"string\">\"person_id\"</span>: <span class=\"string\">\"demo_person_id_zh001\"</span>]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> headers: <span class=\"type\">HTTPHeaders</span> = [</div><div class=\"line\">        <span class=\"string\">\"Host\"</span>: <span class=\"string\">\"service.image.myqcloud.com\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Authorization\"</span>:<span class=\"type\">CloudManager</span>.share.sign</div><div class=\"line\">    ]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"type\">Alamofire</span>.request(url, method: .post, parameters: parameters1, encoding: <span class=\"type\">JSONEncoding</span>.<span class=\"keyword\">default</span>,headers:headers).responseJSON &#123; (responseObject) -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></div><div class=\"line\">        </div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isSuccess &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> <span class=\"type\">JSON</span> = responseObject.result.value</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"type\">JSON</span> != <span class=\"literal\">nil</span>) &#123;</div><div class=\"line\">                <span class=\"comment\">//成功</span></div><div class=\"line\">                </div><div class=\"line\">                <span class=\"built_in\">debugPrint</span>(<span class=\"type\">JSON</span>!)</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                <span class=\"comment\">//失败</span></div><div class=\"line\">                </div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isFailure &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> httpError: <span class=\"type\">NSError</span> = responseObject.result.error! <span class=\"keyword\">as</span> <span class=\"type\">NSError</span></div><div class=\"line\">            <span class=\"keyword\">let</span> statusCode = httpError.code</div><div class=\"line\">            <span class=\"keyword\">let</span> error:<span class=\"type\">NSDictionary</span> = [<span class=\"string\">\"error\"</span> : httpError,<span class=\"string\">\"statusCode\"</span> : statusCode]</div><div class=\"line\">            <span class=\"built_in\">print</span>(error)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//增加人脸</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">addface</span><span class=\"params\">()</span></span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 1.get token</span></div><div class=\"line\">    <span class=\"type\">CloudManager</span>.getToken &#123; (<span class=\"type\">Any</span>) <span class=\"keyword\">in</span></div><div class=\"line\">        <span class=\"keyword\">self</span>.newPerson()</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> url = <span class=\"string\">\"http://service.image.myqcloud.com/face/addface\"</span></div><div class=\"line\">    <span class=\"keyword\">let</span> parameters1: <span class=\"type\">Parameters</span> = [</div><div class=\"line\">        <span class=\"string\">\"appid\"</span>: <span class=\"string\">\"1253464289\"</span>,</div><div class=\"line\">        <span class=\"string\">\"bucket\"</span>: <span class=\"string\">\"taoxi\"</span>,</div><div class=\"line\">        <span class=\"string\">\"group_ids\"</span>:[ <span class=\"string\">\"a007\"</span>],</div><div class=\"line\">        <span class=\"string\">\"person_id\"</span>: <span class=\"string\">\"demo_person_id_zh001\"</span>,</div><div class=\"line\">        <span class=\"string\">\"urls\"</span>: [</div><div class=\"line\">            <span class=\"string\">\"http://taoxi-1253464289.pictj.myqcloud.com/1491467336.23696.jpg\"</span>,</div><div class=\"line\">            <span class=\"string\">\"http://taoxi-1253464289.pictj.myqcloud.com/1491812091.71443.jpg\"</span></div><div class=\"line\">        ]]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> headers: <span class=\"type\">HTTPHeaders</span> = [</div><div class=\"line\">        <span class=\"string\">\"Host\"</span>: <span class=\"string\">\"service.image.myqcloud.com\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Authorization\"</span>:<span class=\"type\">CloudManager</span>.share.sign</div><div class=\"line\">    ]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"type\">Alamofire</span>.request(url, method: .post, parameters: parameters1, encoding: <span class=\"type\">JSONEncoding</span>.<span class=\"keyword\">default</span>,headers:headers).responseJSON &#123; (responseObject) -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></div><div class=\"line\">        </div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isSuccess &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> <span class=\"type\">JSON</span> = responseObject.result.value</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"type\">JSON</span> != <span class=\"literal\">nil</span>) &#123;</div><div class=\"line\">                <span class=\"comment\">//成功</span></div><div class=\"line\">                </div><div class=\"line\">                <span class=\"built_in\">debugPrint</span>(<span class=\"type\">JSON</span>!)</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                <span class=\"comment\">//失败</span></div><div class=\"line\">                </div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isFailure &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> httpError: <span class=\"type\">NSError</span> = responseObject.result.error! <span class=\"keyword\">as</span> <span class=\"type\">NSError</span></div><div class=\"line\">            <span class=\"keyword\">let</span> statusCode = httpError.code</div><div class=\"line\">            <span class=\"keyword\">let</span> error:<span class=\"type\">NSDictionary</span> = [<span class=\"string\">\"error\"</span> : httpError,<span class=\"string\">\"statusCode\"</span> : statusCode]</div><div class=\"line\">            <span class=\"built_in\">print</span>(error)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\"></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">//个体创建</span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newPerson</span><span class=\"params\">()</span></span> &#123;</div><div class=\"line\">    <span class=\"comment\">// 1.get token</span></div><div class=\"line\">    <span class=\"type\">CloudManager</span>.getToken &#123; (<span class=\"type\">Any</span>) <span class=\"keyword\">in</span></div><div class=\"line\">        <span class=\"keyword\">self</span>.newPerson()</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> url = <span class=\"string\">\"http://service.image.myqcloud.com/face/newperson\"</span></div><div class=\"line\">    <span class=\"keyword\">let</span> parameters1: <span class=\"type\">Parameters</span> = [</div><div class=\"line\">        <span class=\"string\">\"appid\"</span>: <span class=\"string\">\"1253464289\"</span>,</div><div class=\"line\">        <span class=\"string\">\"bucket\"</span>: <span class=\"string\">\"taoxi\"</span>,</div><div class=\"line\">        <span class=\"string\">\"group_ids\"</span>:[<span class=\"string\">\"contrastGroup\"</span>],</div><div class=\"line\">        <span class=\"string\">\"person_id\"</span>: <span class=\"string\">\"duyaohui\"</span>,</div><div class=\"line\">        <span class=\"string\">\"url\"</span>: <span class=\"string\">\"http://taoxi-1253464289.costj.myqcloud.com/1492052506.05618.jpg\"</span>]</div><div class=\"line\"></div><div class=\"line\">    <span class=\"keyword\">let</span> parameters2: <span class=\"type\">Parameters</span> = [</div><div class=\"line\">        <span class=\"string\">\"appid\"</span>: <span class=\"string\">\"1253464289\"</span>,</div><div class=\"line\">        <span class=\"string\">\"bucket\"</span>: <span class=\"string\">\"taoxi\"</span>,</div><div class=\"line\">        <span class=\"string\">\"group_ids\"</span>:[<span class=\"string\">\"contrastGroup\"</span>],</div><div class=\"line\">        <span class=\"string\">\"person_id\"</span>: <span class=\"string\">\"wangsong\"</span>,</div><div class=\"line\">        <span class=\"string\">\"url\"</span>: <span class=\"string\">\"http://taoxi-1253464289.costj.myqcloud.com/1492052506.04147.jpg\"</span>]</div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">let</span> headers: <span class=\"type\">HTTPHeaders</span> = [</div><div class=\"line\">        <span class=\"string\">\"Host\"</span>: <span class=\"string\">\"service.image.myqcloud.com\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</div><div class=\"line\">        <span class=\"string\">\"Authorization\"</span>:<span class=\"type\">CloudManager</span>.share.sign</div><div class=\"line\">    ]</div><div class=\"line\">   </div><div class=\"line\">    </div><div class=\"line\">    <span class=\"type\">Alamofire</span>.request(url, method: .post, parameters: parameters2, encoding: <span class=\"type\">JSONEncoding</span>.<span class=\"keyword\">default</span>,headers:headers).responseJSON &#123; (responseObject) -&gt; <span class=\"type\">Void</span> <span class=\"keyword\">in</span></div><div class=\"line\">     </div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isSuccess &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> <span class=\"type\">JSON</span> = responseObject.result.value</div><div class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"type\">JSON</span> != <span class=\"literal\">nil</span>) &#123;</div><div class=\"line\">               <span class=\"comment\">//成功</span></div><div class=\"line\">                </div><div class=\"line\">                <span class=\"built_in\">debugPrint</span>(<span class=\"type\">JSON</span>!)</div><div class=\"line\">            &#125;</div><div class=\"line\">            <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">             <span class=\"comment\">//失败</span></div><div class=\"line\">                </div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">        <span class=\"keyword\">if</span> responseObject.result.isFailure &#123;</div><div class=\"line\">            <span class=\"keyword\">let</span> httpError: <span class=\"type\">NSError</span> = responseObject.result.error! <span class=\"keyword\">as</span> <span class=\"type\">NSError</span></div><div class=\"line\">            <span class=\"keyword\">let</span> statusCode = httpError.code</div><div class=\"line\">            <span class=\"keyword\">let</span> error:<span class=\"type\">NSDictionary</span> = [<span class=\"string\">\"error\"</span> : httpError,<span class=\"string\">\"statusCode\"</span> : statusCode]</div><div class=\"line\">            <span class=\"built_in\">print</span>(error)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>","categories":[],"tags":[]}